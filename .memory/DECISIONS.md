# Решения

## Проект: ai-svetlio

## Формат
Всяко решение се записва така:

### [Дата] Заглавие на решението
**Контекст:** Защо беше нужно това решение
**Решение:** Какво избрахме
**Алтернативи:** Какво друго разгледахме
**Последствия:** Какво следва от решението

---

## Решения

### 2026-02-01 Избор на AI_Svetlio
**Контекст:** Нужда от система за памет и управление на проекти с AI
**Решение:** Използваме AI_Svetlio за .memory/ система
**Алтернативи:** Ръчна документация, други системи
**Последствия:** AI агентите ще имат достъп до контекст между сесии

---

### 2026-02-03 Създаване на Iron Rules документация
**Контекст:** При реална употреба на AI_Svetlio в други проекти беше установено, че AI агентите: "забравят" контекста при дълги чатове, редактират код "на парче" без да четат целия файл, не правят backup преди промени, гадаят пътища вместо да четат документация.
**Решение:** Създадени са 3 документа: IRON_RULES.md (11 задължителни правила), REFRESH_REMINDER.md (кратко напомняне за Context Refresh), USER_GUIDE.md (наръчник за потребителя)
**Алтернативи:** Вграждане директно в кода (отхвърлено - твърде сложно за v1.x), чакане на v2.0 (отхвърлено - проблемът е реален сега)
**Последствия:** Документацията е готова за интеграция в CLAUDE.md шаблона в v1.1.0+

---

### 2026-02-03 Стратегия за версиониране
**Контекст:** Потребителят иска да може да избира между версии при инсталация, без да се губят старите версии.
**Решение:** npm поддържа версиониране автоматично - v1.0.0 остава непроменена, нови функции влизат в v1.1.0+, breaking changes влизат в v2.0.0
**Алтернативи:** Отделни npm пакети за всяка версия (отхвърлено - npm вече поддържа това)
**Последствия:** Потребителите избират версия с `npm install ai-svetlio@версия`

---

### 2026-02-03 Универсални правила за всички IDE
**Контекст:** Потребителят иска максимално прост и универсален инструмент. Без значение кой агент/IDE се ползва (Claude Code, Cursor, Antigravity), правилата трябва да са едни и същи.
**Решение:** Iron Rules се вграждат в шаблоните за CLAUDE.md, .cursorrules, .antigravity/rules.md. При `svetlio init` всички получават идентични правила.
**Алтернативи:** Поддръжка на Gemini CLI, GPT Context и др. (отхвърлено - фокус върху основните 3 IDE)
**Последствия:** v1.1.0 ще включва Iron Rules във всички шаблони. Потребителят не мисли за агента — просто работи.

---

### 2026-02-08 Секция "Споделена отговорност" — задача #1
**Контекст:** Паметта на Светльо се записва от AI агента, но агентът не контролира кога потребителят затваря чата. Ако потребителят затвори преди агентът да запише в `.memory/` — паметта остава неактуална. Това е фундаментално технологично ограничение на всички AI агенти — те не могат да пишат след като сесията е прекратена.
**Решение:** Добавяне на ясна, кратка секция "⚠️ Споделена отговорност" в README.md, USER_GUIDE.md и генерираните шаблони. Текстът обяснява, че потребителят трябва да изчака потвърждение от агента, че паметта е записана, преди да затвори сесията. Това е приоритет #1, преди всички нови функции.
**Алтернативи:** (1) Да не се споменава (отхвърлено — потребителите ще се сблъскат с проблема и ще обвинят инструмента), (2) Автоматичен save при всяко съобщение (отхвърлено — технически невъзможно, агентът решава кога да пише)
**Последствия:** Потребителите ще знаят от самото начало, че трябва да приключват сесиите правилно. Командата `svetlio end` (v1.4.0) ще помогне за формализирането на този процес.

---

### 2026-02-09 Web Viewer — вграден HTTP сървър (v1.4.0)
**Контекст:** Потребителите искат визуален преглед на .memory/ файловете без да ползват CLI или IDE. Нужен е лесен начин да видиш състоянието на проекта в браузъра — read-only, без риск от промени.
**Решение:** Вграден HTTP сървър с Node.js `http` модул (0 нови зависимости). `svetlio web` стартира localhost:3847, отваря браузър, показва всички .memory/ файлове с markdown rendering и auto-refresh на 5 сек. Плюс "един клик" стартиране: `open-memory.bat/.sh` се генерира при `svetlio init`, а `svetlio shortcut` създава desktop shortcut.
**Алтернативи:** (1) Express — отхвърлено, overkill за 1 read-only страница и добавя зависимост; (2) Генериран HTML файл без сървър — отхвърлено, няма live updates; (3) Fastify — отхвърлено, нова зависимост без нужда.
**Последствия:** Потребителите могат да виждат .memory/ визуално без CLI познания. Launcher файлът позволява двоен клик стартиране.

---

### 2026-02-08 Вградени еднодумни workflow команди (v1.4.0)
**Контекст:** Текущите команди (`init`, `onboard`, `repair`) са технически. Потребителят мисли в terms на workflow: "започвам", "продължавам", "приключвам". Нужни са прости, интуитивни команди с по една дума.
**Решение:** 4 нови команди — `старт/start`, `вкарай/import`, `продължи/continue`, `край/end`. Двуезични (БГ + EN). Обвиват съществуващата логика (init, onboard, status) с по-добър UX — шаблони за чата, summary, автоматично обновяване на .memory/.
**Алтернативи:** (1) Само EN имена (отхвърлено — проектът е двуезичен), (2) Многодумни команди като `svetlio start-project` (отхвърлено — идеята е простота с една дума), (3) Интерактивен wizard за всичко (отхвърлено — командите трябва да са бързи)
**Последствия:** v1.4.0 ще предложи прост workflow: `start → continue → end`. Старите команди (`init`, `onboard`) остават за обратна съвместимост.

